<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>San Valentín</title>
    <!-- Favicon San Valentín -->
    <link rel="icon" type="image/png" href="flower.png" />

    <link rel="stylesheet" href="styles.css?v=12223312" />
  </head>
  <body>
    <p class="reload">reload</p>
    <div class="content">
        <!-- Música romántica -->
        <audio id="romanticSong" autoplay loop controls hidden>
        <source src="lovesong.mp3" type="audio/mpeg">
        
        </audio>
      <div class="heart">
        <p class="title">Oprime aquí</p>
        <!-- Botón dentro del mensaje -->
        <p class="message">
        Elia Karen, Amor<br />
        desde que llegaste a mi vida todo tiene más color,<br />
        cada día contigo se siente como un regalo.<br />
        Hoy quiero abrir mi corazón y decirte,<br />
        que no hay nada que desee más<br />
        que compartir este San Valentín contigo.<br />
        ¿Quieres ser mi San Valentín?<br /><br />
        <button id="yesBtn" class="btn-yes">Sí</button>
        </p>

        <!-- Modal personalizado -->
        <div id="valentineModal" class="modal" style="align-items: center;">
        <div class="modal-content">
            <span id="closeModal" class="close">&times;</span>
            <h2>¡Gracias, mi amor!</h2>
            <img src="Love.jpg" alt="Foto romántica" class="photo" style="max-width: 250px;max-height: 350px;">
            <p>Eres mi San Valentín, siempre ❤️</p>
            
            <!-- Contenedor de corazones -->
            <div id="heartsContainer"></div>
        </div>
        </div>


    <script>
      var heart = document.querySelector(".heart"),
          reload = document.querySelector(".reload"),
          hearts = document.querySelector(".hearts"),
          allHearts = document.querySelectorAll(".hearts div"),
          heartAnime = document.querySelector(".heart.anime");

      heart.addEventListener("click", animation);
      reload.addEventListener("click", refresh);

      function animation() {
        try {
            heart.classList.add("active");
            reload.setAttribute("style","opacity: 1; cursor: pointer; pointer-events: auto;");
            heartAnime.style.opacity = "0";
            allHearts.forEach(function (element) {
            element.classList.add("active");
            });
        } catch (error) {
            console.log(error)
        }
        
      }
      // iniciar música al abrir
        romanticSong.play().catch(err => {
            console.log("El navegador bloqueó autoplay, pero el click ya habilitó play:", err);
        });

      function refresh() {
        heart.classList.remove("active");
        reload.setAttribute("style","opacity: 0; pointer-events: none;");
        heartAnime.style.opacity = "1";
        allHearts.forEach(function (element) {
          element.classList.remove("active");
        });
      }

      // Modal personalizado
      const modal = document.getElementById('valentineModal');
      const btnYes = document.getElementById('yesBtn');
      const closeModal = document.getElementById('closeModal');
      const heartsContainer = document.getElementById('heartsContainer');
      let interval;

      btnYes.addEventListener('click', () => {
        modal.style.display = 'flex';
        interval = setInterval(() => {
          const heart = document.createElement('div');
          heart.className = 'heart-shape';
          heart.style.left = Math.random()*90 + '%';
          heart.style.top = '90%';
          heartsContainer.appendChild(heart);
          setTimeout(() => heart.remove(), 3000);
        }, 300);
      });

      closeModal.addEventListener('click', () => {
        modal.style.display = 'none';
        clearInterval(interval);
        heartsContainer.innerHTML = '';
      });

      window.addEventListener('click', (e) => {
        if(e.target === modal){
          modal.style.display = 'none';
          clearInterval(interval);
          heartsContainer.innerHTML = '';
        }
      });
    </script>
  </body>
</html>